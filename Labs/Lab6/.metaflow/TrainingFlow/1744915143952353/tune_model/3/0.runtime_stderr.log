[MFLOG|0|2025-04-17T18:39:07.886873Z|runtime|6b8863fe-30e7-4ccf-9b22-017bd4d784fa]<flow TrainingFlow step tune_model> failed:
[MFLOG|0|2025-04-17T18:39:07.915421Z|runtime|2d5d11cb-45b7-4ffe-9151-8db4de74dde3]    Internal error
[MFLOG|0|2025-04-17T18:39:07.916258Z|runtime|27873589-346a-437d-a010-c42dfe9a59cd]Traceback (most recent call last):
[MFLOG|0|2025-04-17T18:39:07.916320Z|runtime|f3ef0201-92e4-478a-8b62-1db36e3d46b5]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/cli.py", line 611, in main
[MFLOG|0|2025-04-17T18:39:07.916350Z|runtime|c09184f9-35da-4a92-9cda-a7eaaaed0f19]    start(auto_envvar_prefix="METAFLOW", obj=state)
[MFLOG|0|2025-04-17T18:39:07.916378Z|runtime|3e924c1a-403b-4903-9ef1-aba25287723f]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/_vendor/click/core.py", line 829, in __call__
[MFLOG|0|2025-04-17T18:39:07.916401Z|runtime|b0cc2031-71e8-454f-a9dd-39be268a13e4]    return self.main(args, kwargs)
[MFLOG|0|2025-04-17T18:39:08.026209Z|runtime|fd30e84d-75e0-4b42-ac5b-79a547b16cfd]           ^^^^^^^^^^^^^^^^^^^^^^^^^^
[MFLOG|0|2025-04-17T18:39:08.026339Z|runtime|f241a892-5584-41eb-a188-984d882a167e]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/_vendor/click/core.py", line 782, in main
[MFLOG|0|2025-04-17T18:39:08.026373Z|runtime|a804ecf1-e158-4ea7-af82-42b230454c1b]    rv = self.invoke(ctx)
[MFLOG|0|2025-04-17T18:39:08.026395Z|runtime|168b7660-7298-4a65-87dc-71d76a832f7e]         ^^^^^^^^^^^^^^^^
[MFLOG|0|2025-04-17T18:39:08.026421Z|runtime|68d99c05-cdf2-4695-bb98-c21536b62666]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/cli_components/utils.py", line 69, in invoke
[MFLOG|0|2025-04-17T18:39:08.026445Z|runtime|2a6bb859-7c51-4012-8814-6871142f0df7]    return _process_result(sub_ctx.command.invoke(sub_ctx))
[MFLOG|0|2025-04-17T18:39:08.026465Z|runtime|c0c1186b-41b5-4fba-ad38-727fba61d78d]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[MFLOG|0|2025-04-17T18:39:08.026489Z|runtime|5752040e-7ead-46a9-a112-6e3526ab6423]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/_vendor/click/core.py", line 1066, in invoke
[MFLOG|0|2025-04-17T18:39:08.026508Z|runtime|56f24b23-db81-4dbd-aee2-09e813473625]    return ctx.invoke(self.callback, ctx.params)
[MFLOG|0|2025-04-17T18:39:08.026537Z|runtime|a675403e-1c75-4f8a-b280-0d901b41d904]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[MFLOG|0|2025-04-17T18:39:08.026559Z|runtime|f30fe315-1457-46a4-ba54-63b5d7e073ca]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/_vendor/click/core.py", line 610, in invoke
[MFLOG|0|2025-04-17T18:39:08.026579Z|runtime|bb98dd73-d35d-4232-9a57-bf41c1d15941]    return callback(args, kwargs)
[MFLOG|0|2025-04-17T18:39:08.026600Z|runtime|6c92cec0-c28e-4831-acd6-130961faedae]           ^^^^^^^^^^^^^^^^^^^^^^^^^
[MFLOG|0|2025-04-17T18:39:08.026621Z|runtime|b4025ef3-dbc0-4458-b7a5-cdd376c2ca16]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/tracing/__init__.py", line 27, in wrapper_func
[MFLOG|0|2025-04-17T18:39:08.026639Z|runtime|6fa4e4fd-b516-428e-b976-63ff2388adc8]    return func(args, kwargs)
[MFLOG|0|2025-04-17T18:39:08.026658Z|runtime|7c75b338-ae00-456f-8f88-da06c9c47723]           ^^^^^^^^^^^^^^^^^^^^^
[MFLOG|0|2025-04-17T18:39:08.026675Z|runtime|c1abbaaf-52d5-4538-b2bb-e861d7af547b]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/_vendor/click/decorators.py", line 21, in new_func
[MFLOG|0|2025-04-17T18:39:08.026697Z|runtime|92946ec9-eb59-477f-992c-e0e49a4fb8d1]    return f(get_current_context(), args, kwargs)
[MFLOG|0|2025-04-17T18:39:08.026718Z|runtime|fb1fe5cc-eebe-4c3d-b7ff-f4303baeebb8]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[MFLOG|0|2025-04-17T18:39:08.026736Z|runtime|28dd31d7-e657-4bec-8077-5f34ea5529a2]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/cli_components/step_cmd.py", line 167, in step
[MFLOG|0|2025-04-17T18:39:08.026757Z|runtime|e1bfc656-ff77-4a8b-ad11-bf1e591227b2]    task.run_step(
[MFLOG|0|2025-04-17T18:39:08.026778Z|runtime|06dc5ce6-a362-412d-bef0-6a1aec1be353]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/task.py", line 672, in run_step
[MFLOG|0|2025-04-17T18:39:08.026796Z|runtime|d6abb402-4427-4e58-bc58-39391f3a8127]    self._exec_step_function(step_func)
[MFLOG|0|2025-04-17T18:39:08.026815Z|runtime|ec99a6f1-8b81-4656-99b9-f75cf1873458]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/metaflow/task.py", line 62, in _exec_step_function
[MFLOG|0|2025-04-17T18:39:08.026838Z|runtime|af6f382c-c620-48c1-bd1d-e56490d2bea0]    step_function()
[MFLOG|0|2025-04-17T18:39:08.026858Z|runtime|b087d89b-b28c-455e-a031-1500437a21f5]  File "/Users/jahnavipaliwal/Desktop/ML_Ops/MLOps/Labs/Lab6/src/trainingflow.py", line 33, in tune_model
[MFLOG|0|2025-04-17T18:39:08.026876Z|runtime|845f605a-ede1-4792-aec2-6d04b1bee4b5]    grid_search.fit(self.X, self.y)
[MFLOG|0|2025-04-17T18:39:08.026893Z|runtime|b632a0e2-0729-4c4a-b385-4f61482eafd3]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/base.py", line 1473, in wrapper
[MFLOG|0|2025-04-17T18:39:08.026913Z|runtime|aa3863c1-dec6-46c8-abe1-ed21852fb51b]    return fit_method(estimator, args, kwargs)
[MFLOG|0|2025-04-17T18:39:08.026932Z|runtime|5531b797-194b-4b55-b32f-f6528d917a8e]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[MFLOG|0|2025-04-17T18:39:08.026951Z|runtime|e309a8de-2104-43c9-b4c2-6047b1a33d96]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/model_selection/_search.py", line 1018, in fit
[MFLOG|0|2025-04-17T18:39:08.026971Z|runtime|200e9509-d93e-46ac-be1c-4bf688c389d7]    self._run_search(evaluate_candidates)
[MFLOG|0|2025-04-17T18:39:08.026989Z|runtime|a6830e95-80ba-4be6-a266-b82292a00e0e]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/model_selection/_search.py", line 1572, in _run_search
[MFLOG|0|2025-04-17T18:39:08.027006Z|runtime|75042936-2db4-468e-a230-8cdcfbde082d]    evaluate_candidates(ParameterGrid(self.param_grid))
[MFLOG|0|2025-04-17T18:39:08.027025Z|runtime|db953201-783a-44d2-ac1e-44a37987e6bb]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/model_selection/_search.py", line 995, in evaluate_candidates
[MFLOG|0|2025-04-17T18:39:08.027053Z|runtime|7b3ab770-1783-480b-987c-5105e84c49b2]    _warn_or_raise_about_fit_failures(out, self.error_score)
[MFLOG|0|2025-04-17T18:39:08.027073Z|runtime|881fbef4-7910-462f-a440-4842aabcca62]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 529, in _warn_or_raise_about_fit_failures
[MFLOG|0|2025-04-17T18:39:08.027095Z|runtime|528e2f45-f160-4681-832d-202cd779e6e6]    raise ValueError(all_fits_failed_message)
[MFLOG|0|2025-04-17T18:39:08.027115Z|runtime|9e500c19-aeaf-4a6b-8804-6cfe2d16b675]ValueError: 
[MFLOG|0|2025-04-17T18:39:08.027134Z|runtime|c2093f09-8008-4a46-8bea-139fc90fbf97]All the 12 fits failed.
[MFLOG|0|2025-04-17T18:39:08.027152Z|runtime|9878ad5a-d68f-4056-9cbf-ba7e31efa55f]It is very likely that your model is misconfigured.
[MFLOG|0|2025-04-17T18:39:08.027169Z|runtime|89d48de6-09ec-4eb4-bb1b-d1040d698700]You can try to debug the error by setting error_score='raise'.
[MFLOG|0|2025-04-17T18:39:08.027187Z|runtime|d4eac771-7138-48f0-91a2-6f61b09c4a2a]
[MFLOG|0|2025-04-17T18:39:08.027206Z|runtime|f08c09f1-1960-4e13-89dd-a11bde3edb26]Below are more details about the failures:
[MFLOG|0|2025-04-17T18:39:08.027224Z|runtime|74127a44-f708-4ddd-a1eb-35d798785107]--------------------------------------------------------------------------------
[MFLOG|0|2025-04-17T18:39:08.027241Z|runtime|9f949da3-e724-4947-a75d-2ed8a5bcf89d]12 fits failed with the following error:
[MFLOG|0|2025-04-17T18:39:08.027262Z|runtime|e3c61486-b6a1-4487-8b50-c82ac7bab680]Traceback (most recent call last):
[MFLOG|0|2025-04-17T18:39:08.027279Z|runtime|9ae3db14-cf51-4c2d-8a06-a879a2c2e10f]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 888, in _fit_and_score
[MFLOG|0|2025-04-17T18:39:08.027296Z|runtime|759db7f2-317c-4a6c-a5a0-bd2dc1e91ade]    estimator.fit(X_train, y_train, fit_params)
[MFLOG|0|2025-04-17T18:39:08.027315Z|runtime|da4b205f-2a4c-41be-a808-8c2f99389c94]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/base.py", line 1473, in wrapper
[MFLOG|0|2025-04-17T18:39:08.027332Z|runtime|75e602eb-1b9f-4557-983c-989b66500f2c]    return fit_method(estimator, args, kwargs)
[MFLOG|0|2025-04-17T18:39:08.027347Z|runtime|d547b486-e075-4086-9244-fdb4b3e707b1]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[MFLOG|0|2025-04-17T18:39:08.027364Z|runtime|e0aa7b20-a090-41ec-a78c-b245e35749bc]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/ensemble/_forest.py", line 377, in fit
[MFLOG|0|2025-04-17T18:39:08.027382Z|runtime|fcbc20cf-4b0a-4395-b315-ef31f44f5844]    estimator._compute_missing_values_in_feature_mask(
[MFLOG|0|2025-04-17T18:39:08.027399Z|runtime|948f83f9-1a6b-46bf-9456-9fe65b957c70]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/tree/_classes.py", line 214, in _compute_missing_values_in_feature_mask
[MFLOG|0|2025-04-17T18:39:08.027414Z|runtime|846ff478-bce6-472d-9d34-ae402d57047f]    assert_all_finite(X, common_kwargs)
[MFLOG|0|2025-04-17T18:39:08.027430Z|runtime|864c5e59-e9c7-4a3c-b8ca-c58ce167cb89]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/utils/validation.py", line 213, in assert_all_finite
[MFLOG|0|2025-04-17T18:39:08.027448Z|runtime|81dc67cf-bf0b-483c-9091-5ef268ae94d2]    _assert_all_finite(
[MFLOG|0|2025-04-17T18:39:08.027467Z|runtime|52acd65a-2dae-47c6-8dfa-690bce413589]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/utils/validation.py", line 123, in _assert_all_finite
[MFLOG|0|2025-04-17T18:39:08.027483Z|runtime|73956b8f-88ee-4247-bdaf-b3e36c4d5de8]    _assert_all_finite_element_wise(
[MFLOG|0|2025-04-17T18:39:08.027501Z|runtime|b106503a-9ee0-456b-9063-8164b6e93f86]  File "/opt/anaconda3/envs/mlops/lib/python3.12/site-packages/sklearn/utils/validation.py", line 172, in _assert_all_finite_element_wise
[MFLOG|0|2025-04-17T18:39:08.027518Z|runtime|f47ce976-895e-4541-a7a5-722848232857]    raise ValueError(msg_err)
[MFLOG|0|2025-04-17T18:39:08.027536Z|runtime|d0a523b8-85b9-4c9b-a142-b0b8f69569d0]ValueError: Input X contains NaN.
[MFLOG|0|2025-04-17T18:39:08.027554Z|runtime|3042a6b6-b216-4078-bc6c-ace4fe055f0f]RandomForestClassifier does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
[MFLOG|0|2025-04-17T18:39:08.027580Z|runtime|fafa26c2-8c09-4b23-be36-de8e00d168ed]
[MFLOG|0|2025-04-17T18:39:08.027598Z|runtime|b3a6f5a3-fbb8-486d-b82a-df8529f54b43]
[MFLOG|0|2025-04-17T18:39:08.027908Z|runtime|9c0857a1-0a15-437b-864f-35d7a073fa83]Task failed.